var elements_of_pagetop_class = $(".pagetop");
if(elements_of_pagetop_class.length && elements_of_pagetop_class.length > 0)
{
	var prev = $(elements_of_pagetop_class[0]).html();
	var newhtml = prev + " | <a href=\"#\" id=\"feed_link\">feed</a> (<span id=\"newsfeed_count_span\">-</span>) | <a href=\"#\" id=\"notification_link\">notifications</a> (<span id=\"notification_count_span\">-</span>) ";
	newhtml = newhtml + "<span id=\"use_button_span\" style=\"padding-left:5px;display:none\">Use <img style=\"width:16px;height:16px;vertical-align:middle\" src=\"" + chrome.extension.getURL("images/h_button_19_gray.png") + "\"></span>";
	$(elements_of_pagetop_class[0]).html(newhtml);
	$("#feed_link").click(function(){
		$("#use_button_span").show();
		setTimeout(function() { $("#use_button_span").hide(); }, 2000);
		return false;
	});
	$("#notification_link").click(function(){
		$("#use_button_span").show();
		setTimeout(function() { $("#use_button_span").hide(); }, 2000);
		return false;
	});
	
	chrome.runtime.sendMessage({method: "getCounts"}, function(response) { 
		if(typeof response.notification_count !== "undefined" && response.notification_count !== null && typeof response.newsfeed_count !== "undefined" && response.newsfeed_count !== null)
		{
			$("#notification_count_span").text(response.notification_count);
			$("#newsfeed_count_span").text(response.newsfeed_count);
		}	
		
		// this line checks for feed number updates every 30 seconds, stopping after 10 minutes
		setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}setTimeout(function(){chrome.runtime.sendMessage({method:"getCounts"},function(e){if(typeof e.notification_count!=="undefined"&&e.notification_count!==null&&typeof e.newsfeed_count!=="undefined"&&e.newsfeed_count!==null){$("#notification_count_span").text(e.notification_count);$("#newsfeed_count_span").text(e.newsfeed_count)}else{$("#notification_count_span").text("-");$("#newsfeed_count_span").text("-")}})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)})},3e4)
	});
}			


	